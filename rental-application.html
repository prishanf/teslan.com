<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Residential Rental Application</title>

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js"></script>

<!-- Signature Pad -->
<script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>

<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: Arial, sans-serif;
    padding: 20px;
    background: #f5f5f5;
}

.container {
    max-width: 850px;
    margin: 0 auto;
    background: white;
    padding: 40px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
}

h1 {
    text-align: center;
    color: #2c3e50;
    margin-bottom: 10px;
    font-size: 24px;
}

.subtitle {
    text-align: center;
    color: #7f8c8d;
    margin-bottom: 30px;
    font-size: 14px;
}

h2 {
    background: #DDD;
    color: #2c3e50;
    padding: 10px;
    margin-top: 25px;
    margin-bottom: 15px;
    font-size: 16px;
}

h3 {
    color: #2c3e50;
    margin-top: 20px;
    margin-bottom: 10px;
    font-size: 14px;
    border-bottom: 2px solid #000;
    padding-bottom: 5px;
}

.form-group {
    margin-bottom: 15px;
}

.form-row {
    display: flex;
    gap: 15px;
    margin-bottom: 15px;
}

.form-row>div {
    flex: 1;
}

label {
    display: block;
    font-weight: bold;
    margin-bottom: 5px;
    color: #2c3e50;
    font-size: 13px;
}

input[type="text"],
input[type="email"],
input[type="tel"],
input[type="date"],
input[type="number"],
select,
textarea {
    width: 100%;
    padding: 8px;
    border: 1px solid #bdc3c7;
    border-radius: 4px;
    font-size: 14px;
}

textarea {
    resize: vertical;
    min-height: 60px;
}

.checkbox-group {
    display: flex;
    gap: 20px;
    align-items: center;
}

.checkbox-group label {
    display: flex;
    align-items: center;
    font-weight: normal;
    margin-bottom: 0;
}

.checkbox-group input[type="radio"],
.checkbox-group input[type="checkbox"] {
    width: auto;
    margin-right: 5px;
}

.info-box {
    background: #ecf0f1;
    padding: 15px;
    border-left: 4px solid #3498db;
    margin-bottom: 20px;
    font-size: 13px;
}

.signature-section {
    margin-top: 30px;
    border-top: 2px solid #34495e;
    padding-top: 20px;
}

.consent-text {
    font-size: 12px;
    line-height: 1.6;
    margin-bottom: 20px;
    text-align: justify;
}

.consent-text ul {
    margin-left: 20px;
    margin-top: 10px;
}

.consent-text li {
    margin-bottom: 8px;
}

.signature-row {
    display: flex;
    gap: 20px;
    margin-top: 20px;

}

.signature-field {
    flex: 1;
    padding-bottom: 20px;
    border: none;
}

.button-container {
    display: flex;
    gap: 10px;
    margin-top: 30px;
    justify-content: center;
    flex-wrap: wrap;
}

button {
    padding: 12px 30px;
    font-size: 16px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: background 0.3s;
}

.btn-download {
    background: #27ae60;
    color: white;
}

.btn-download:hover {
    background: #229954;
}

.btn-blank {
    background: #3498db;
    color: white;
}

.btn-blank:hover {
    background: #2980b9;
}

.btn-clear {
    background: #e74c3c;
    color: white;
}

.btn-clear:hover {
    background: #c0392b;
}

.small-text {
    font-size: 11px;
    color: #7f8c8d;
    font-style: italic;
}

.signature-box {
    padding: 0;
    margin: 0;
    font-size: 14px;
    border-bottom: 1px solid #000;
    padding-top: 40px;
}

.signature-pad-container {
    margin: 15px 0;
}

.signature-pad-container canvas {
    border: 1px solid #bdc3c7;
    border-radius: 4px;
    background: white;
    cursor: crosshair;
    width: 100%;
    max-width: 400px;
    height: 150px;
}

.signature-pad-container label {
    margin-bottom: 8px;
}

.signature-controls {
    margin-top: 10px;
}

.signature-controls button {
    padding: 8px 15px;
    font-size: 14px;
    margin-right: 10px;
}

.typed-signature {
    width: 100%;
    padding: 8px;
    border: 1px solid #bdc3c7;
    border-radius: 4px;
    font-size: 14px;
    margin-top: 10px;
}

@media print {
    body {
        background: white;
        padding: 0;
    }

    .container {
        box-shadow: none;
        padding: 20px;
    }

    .button-container {
        display: none;
    }
}

/* Force page break before an element */
.page-break-before {
    page-break-before: always;
    break-before: page;
    /* Modern syntax */
}

/* Force page break after an element */
.page-break-after {
    page-break-after: always;
    break-after: page;
    /* Modern syntax */
}

/* Avoid page breaks inside an element */
.no-break-inside {
    page-break-inside: avoid;
    break-inside: avoid;
    /* Modern syntax */
}
</style>
</head>

<body>

<div class="container">
<form id="appForm">
        <h1>RESIDENTIAL RENTAL APPLICATION</h1>
        <p class="subtitle">Please complete all sections accurately and legibly</p>

        <div class="info-box"><strong>Required Documentation:</strong> You must present two (2) pieces of
            government-issued identification for verification. Incomplete applications will not be processed.</div>

        <h2>PROPERTY INFORMATION</h2>
        <div class="form-row">
            <div>
                <label>Property Address Applying For:</label>
                <input type="text" id="property_address" value="10488 138A St, Surrey, BC V3T 4L3"/>
            </div>
        </div>
        <div class="form-row">
            <div>
                <label>Desired Move-In Date:(YYYY-MM)</label>
                <input type="text" id="move_in_date" />
            </div>
            <div>
                <label>Lease Term Requested: (1,2,3 Years)</label>
                <input type="text" id="lease_term" />
            </div>
        </div>

        <h2>PERSONAL INFORMATION - PRIMARY APPLICANT</h2>
        <div class="form-row">
            <div>
                <label>Full Legal Name:</label>
                <input type="text" id="full_name" />
            </div>
        </div>
        <div class="form-row">
            <div>
                <label>Date of Birth:(YYYY-MM-DD)</label>
                <input type="text" id="birthdate" />
            </div>
            <div>
                <label>Marital Status:</label>
                <input type="text" id="marital_status" />
            </div>
        </div>

        <div class="form-row">
            <div>
                <label>Primary Phone:</label>
                <input type="tel" id="phone" />
            </div>
            <div>
                <label>Alternate Phone:</label>
                <input type="tel" id="cell" />
            </div>
        </div>

        <div class="form-group">
            <label>Email Address:</label>
            <input type="email" id="email" />
        </div>

        <div class="form-row">
            <div>
                <label>Driver's License / ID Number:</label>
                <input type="text" id="license" />
            </div>
            <div>
                <label>Province/State of Issue:</label>
                <input type="text" id="license_province" />
            </div>
        </div>

        <div class="form-row"></div>

        <h2 class="page-break-before">CURRENT RESIDENCE</h2>
        <div class="form-group">
            <label>Current Address:</label>
            <input type="text" id="current_address" />
        </div>

        <div class="form-row">
            <div>
                <label>City:</label>
                <input type="text" id="current_city" />
            </div>
            <div>
                <label>Province:</label>
                <input type="text" id="current_province" />
            </div>
            <div>
                <label>Postal Code:</label>
                <input type="text" id="current_postal" />
            </div>
        </div>

        <div class="form-row">
            <div>
                <label>Landlord/Property Manager Name:</label>
                <input type="text" id="current_landlord" />
            </div>
            <div>
                <label>Landlord Phone:</label>
                <input type="tel" id="current_landlord_phone" />
            </div>
        </div>

        <div class="form-row">
            <div>
                <label>Monthly Rent:</label>
                <input type="text" id="current_rent" />
            </div>
            <div>
                <label>Move-In Date:(YYYY-MM-DD)</label>
                <input type="text" id="current_start" />
            </div>
            <div>
                <label>Move-Out Date:(YYYY-MM-DD)</label>
                <input type="text" id="current_end" />
            </div>
        </div>

        <div class="form-group">
            <label>Reason for Leaving:</label>
            <input type="text" id="reason_leaving" />
        </div>

        <h3>Previous Address #1</h3>
        <div class="form-group">
            <label>Address:</label>
            <input type="text" id="prev_address_1" />
        </div>

        <div class="form-row">
            <div>
                <label>City:</label>
                <input type="text" id="prev_city_1" />
            </div>
            <div>
                <label>Province:</label>
                <input type="text" id="prev_province_1" />
            </div>
            <div>
                <label>Postal Code:</label>
                <input type="text" id="prev_postal_1" />
            </div>
        </div>

        <div class="form-row">
            <div>
                <label>Landlord Name:</label>
                <input type="text" id="prev_landlord_1" />
            </div>
            <div>
                <label>Landlord Phone:</label>
                <input type="tel" id="prev_landlord_phone_1" />
            </div>
        </div>

        <div class="form-row">
            <div>
                <label>Monthly Rent:</label>
                <input type="text" id="prev_rent_1" />
            </div>
            <div>
                <label>From Date:(YYYY-MM-DD)</label>
                <input type="text" id="prev_start_1" />
            </div>
            <div>
                <label>To Date:(YYYY-MM-DD)</label>
                <input type="text" id="prev_end_1" />
            </div>
        </div>

        <h3 class="page-break-before">Previous Address #2</h3>
        <div class="form-group">
            <label>Address:</label>
            <input type="text" id="prev_address_2" />
        </div>

        <div class="form-row">
            <div>
                <label>City:</label>
                <input type="text" id="prev_city_2" />
            </div>
            <div>
                <label>Province:</label>
                <input type="text" id="prev_province_2" />
            </div>
            <div>
                <label>Postal Code:</label>
                <input type="text" id="prev_postal_2" />
            </div>
        </div>

        <div class="form-row">
            <div>
                <label>Landlord Name:</label>
                <input type="text" id="prev_landlord_2" />
            </div>
            <div>
                <label>Landlord Phone:</label>
                <input type="tel" id="prev_landlord_phone_2" />
            </div>
        </div>

        <div class="form-row">
            <div>
                <label>Monthly Rent:</label>
                <input type="text" id="prev_rent_2" />
            </div>
            <div>
                <label>From Date:(YYYY-MM-DD)</label>
                <input type="text" id="prev_start_2" />
            </div>
            <div>
                <label>To Date:(YYYY-MM-DD)</label>
                <input type="text" id="prev_end_2" />
            </div>
        </div>

        <h2>EMPLOYMENT & INCOME</h2>
        <h3>Current Employment</h3>
        <div class="form-row">
            <div>
                <label>Employer Name:</label>
                <input type="text" id="employer" />
            </div>
            <div>
                <label>Occupation/Position:</label>
                <input type="text" id="occupation" />
            </div>
        </div>

        <div class="form-group">
            <label>Employer Address:</label>
            <input type="text" id="employer_address" />
        </div>

        <div class="form-row">
            <div>
                <label>Supervisor Name:</label>
                <input type="text" id="supervisor" />
            </div>
            <div>
                <label>Employer Phone:</label>
                <input type="tel" id="employer_phone" />
            </div>
        </div>

        <div class="form-row">
            <div>
                <label>Employment Start Date(YYYY-MM)</label>
                <input type="text" id="employment_start" />
            </div>
            <div>
                <label>Gross Monthly Income:</label>
                <input type="text" id="monthly_income" />
            </div>
        </div>

        <div class="form-row">
            <div>
                <label>Employment Type:(Full-Time,Part-Time,Self-Employed)</label>
                <input type="text" id="employment_type" />
            </div>
        </div>

        <h3 class="page-break-before">Previous Employment</h3>
        <div class="form-row">
            <div>
                <label>Employer Name:</label>
                <input type="text" id="prev_employer" />
            </div>
            <div>
                <label>Occupation/Position:</label>
                <input type="text" id="prev_occupation" />
            </div>
        </div>

        <div class="form-row">
            <div>
                <label>Employer Phone:</label>
                <input type="tel" id="prev_employer_phone" />
            </div>
            <div>
                <label>From Date:(YYYY-MM)</label>
                <input type="text" id="prev_employment_start" />
            </div>
            <div>
                <label>To Date:(YYYY-MM)</label>
                <input type="text" id="prev_employment_end" />
            </div>
        </div>

        <h3>Additional Income Sources</h3>
        <div class="form-row">
            <div class="">
                <label>Other Income (pension, investments, etc):</label>
                <input type="text" id="other_income_source" />
            </div>
            <div class="">
                <label>Monthly Amount:</label>
                <input type="text" id="other_income_amount" />
            </div>
        </div>

        <h2>VEHICLE INFORMATION</h2>
        <div class="form-row">
            <div>
                <label>Do you own a vehicle?</label>
                <div class="checkbox-group">
                    <label><input type="radio" name="vehicle_owned" value="yes" /> Yes</label>
                    <label><input type="radio" name="vehicle_owned" value="no" /> No</label>
                </div>
            </div>
        </div>
        <div class="form-row">
            <div>
                <label>Vehicle Make/Model:</label>
                <input type="text" id="vehicle_make" />
            </div>
            <div>
                <label>Year:</label>
                <input type="text" id="vehicle_year" />
            </div>
            <div>
                <label>License Plate:</label>
                <input type="text" id="vehicle_plate" />
            </div>
        </div>

        <h2>ADDITIONAL OCCUPANTS</h2>
        <h3>Spouse/Co-Applicant (if applicable)</h3>
        <div class="form-row">
            <div>
                <label>Full Name:</label>
                <input type="text" id="spouse_name" />
            </div>
            <div>
                <label>Date of Birth:</label>
                <input type="date" id="spouse_dob" />
            </div>
        </div>

        <div class="form-row">
            <div>
                <label>Phone:</label>
                <input type="tel" id="spouse_phone" />
            </div>
            <div>
                <label>Email:</label>
                <input type="email" id="spouse_email" />
            </div>
        </div>

        <div class="form-row">
            <div>
                <label>Employer:</label>
                <input type="text" id="spouse_employer" />
            </div>
            <div>
                <label>Occupation:</label>
                <input type="text" id="spouse_occupation" />
            </div>
        </div>

        <div class="form-row">
            <div>
                <label>Employer Phone:</label>
                <input type="tel" id="spouse_employer_phone" />
            </div>
            <div>
                <label>Gross Monthly Income:</label>
                <input type="text" id="spouse_income" />
            </div>
        </div>

        <h3>Other Occupants</h3>
        <div class="form-row">
            <div>
                <label>Number of Adults (18+):</label>
                <input type="number" id="num_adults" min="0" />
            </div>
            <div>
                <label>Number of Children (Under 18):</label>
                <input type="number" id="num_children" min="0" />
            </div>
        </div>

        <div class="form-group">
            <label>List All Occupants (Name, Age, Relationship):</label>
            <div class="form-row">
                <div>
                    <label>Name:</label>
                    <input type="text" id="occupant1_name" />
                </div>
                <div>
                    <label>Relationship:</label>
                    <input type="text" id="occupant1_relationship" />
                </div>
                <div>
                    <label>Age:</label>
                    <input type="text" id="occupant1_age" />
                </div>
            </div>
            <div class="form-row">
                <div>
                    <label>Name:</label>
                    <input type="text" id="occupant2_name" />
                </div>
                <div>
                    <label>Relationship:</label>
                    <input type="text" id="occupant2_relationship" />
                </div>
                <div>
                    <label>Age:</label>
                    <input type="text" id="occupant2_age" />
                </div>
            </div>
            <div class="form-row">
                <div>
                    <label>Name:</label>
                    <input type="text" id="occupant3_name" />
                </div>
                <div>
                    <label>Relationship:</label>
                    <input type="text" id="occupant3_relationship" />
                </div>
                <div>
                    <label>Age:</label>
                    <input type="text" id="occupant3_age" />
                </div>
            </div>
        </div>

        <h2>PETS & SMOKING</h2>
        <div class="form-row">
            <div>
                <label>Do you have pets?</label>
                <div class="checkbox-group">
                    <label><input type="radio" name="pets" value="yes" /> Yes</label>
                    <label><input type="radio" name="pets" value="no" /> No</label>
                </div>
            </div>
            <div>
                <label>Do you or any occupants smoke?</label>
                <div class="checkbox-group">
                    <label><input type="radio" name="smokers" value="yes" /> Yes</label>
                    <label><input type="radio" name="smokers" value="no" /> No</label>
                </div>
            </div>
        </div>

        <div class="form-group">
            <label>If yes to pets, provide details (type, breed, weight, age):</label>
            <textarea id="pet_details" rows="5"></textarea>
        </div>
        <h2>EMERGENCY CONTACT</h2>
        <div class="form-row">
            <div>
                <label>Name:</label>
                <input type="text" id="emergency_name" />
            </div>
            <div>
                <label>Relationship:</label>
                <input type="text" id="emergency_relationship" />
            </div>
        </div>
        <div class="form-row">
            <div>
                <label>Phone:</label>
                <input type="tel" id="emergency_phone" />
            </div>
            <div>
                <label>Alternate Phone:</label>
                <input type="tel" id="emergency_alt_phone" />
            </div>
        </div>


        <h2 class="page-break-before">REFERENCES</h2>
        <p class="small-text">Please provide three (3) references (not family members)</p>

        <h3>Reference 1</h3>
        <div class="form-row">
            <div>
                <label>Name:</label>
                <input type="text" id="ref1_name" />
            </div>
            <div>
                <label>Relationship:</label>
                <input type="text" id="ref1_relationship" />
            </div>
        </div>
        <div class="form-row">
            <div>
                <label>Phone:</label>
                <input type="tel" id="ref1_phone" />
            </div>
            <div>
                <label>Email:</label>
                <input type="email" id="ref1_email" />
            </div>
        </div>

        <h3>Reference 2</h3>
        <div class="form-row">
            <div>
                <label>Name:</label>
                <input type="text" id="ref2_name" />
            </div>
            <div>
                <label>Relationship:</label>
                <input type="text" id="ref2_relationship" />
            </div>
        </div>
        <div class="form-row">
            <div>
                <label>Phone:</label>
                <input type="tel" id="ref2_phone" />
            </div>
            <div>
                <label>Email:</label>
                <input type="email" id="ref2_email" />
            </div>
        </div>

        <h3>Reference 3</h3>
        <div class="form-row">
            <div>
                <label>Name:</label>
                <input type="text" id="ref3_name" />
            </div>
            <div>
                <label>Relationship:</label>
                <input type="text" id="ref3_relationship" />
            </div>
        </div>
        <div class="form-row">
            <div>
                <label>Phone:</label>
                <input type="tel" id="ref3_phone" />
            </div>
            <div>
                <label>Email:</label>
                <input type="email" id="ref3_email" />
            </div>
        </div>

        
        <h2 class="page-break-before">ADDITIONAL QUESTIONS</h2>
        <div class="form-group">
            <label>Have you ever been evicted from a rental property?</label>
            <div class="checkbox-group">
                <label><input type="radio" name="evicted" value="yes" /> Yes</label>
                <label><input type="radio" name="evicted" value="no" /> No</label>
            </div>
            <div style="margin-top: 10px;">
                <label>If yes, please explain:</label>
                <textarea id="evicted_explanation"></textarea>
            </div>
        </div>

        <div class="form-group">
            <label>Have you ever broken a lease or rental agreement?</label>
            <div class="checkbox-group">
                <label><input type="radio" name="broken_lease" value="yes" /> Yes</label>
                <label><input type="radio" name="broken_lease" value="no" /> No</label>
            </div>
            <div style="margin-top: 10px;">
                <label>If yes, please explain:</label>
                <textarea id="broken_lease_explanation"></textarea>
            </div>
        </div>

        <div class="form-group">
            <label>Have you ever filed for bankruptcy?</label>
            <div class="checkbox-group">
                <label><input type="radio" name="bankruptcy" value="yes" /> Yes</label>
                <label><input type="radio" name="bankruptcy" value="no" /> No</label>
            </div>
            <div style="margin-top: 10px;">
                <label>If yes, when and status:</label>
                <input type="text" id="bankruptcy_details" />
            </div>
        </div>

        <div class="form-group">
            <label>Have you ever been convicted of a criminal offense?</label>
            <div class="checkbox-group">
                <label><input type="radio" name="criminal" value="yes" /> Yes</label>
                <label><input type="radio" name="criminal" value="no" /> No</label>
            </div>
            <div style="margin-top: 10px;">
                <label>If yes, please explain:</label>
                <textarea id="criminal_explanation"></textarea>
            </div>
        </div>

        <div class="form-group">
            <label>Do you have renters insurance or plan to obtain it?</label>
            <div class="checkbox-group">
                <label><input type="radio" name="insurance" value="yes" /> Yes</label>
                <label><input type="radio" name="insurance" value="no" /> No</label>
                <label><input type="radio" name="insurance" value="will_obtain" /> Will Obtain</label>
            </div>
        </div>

        <h2>ADDITIONAL INFORMATION</h2>

        <div class="form-group">
            <label>Is there any additional information you would like to provide?</label>
            <textarea id="additional_info"></textarea>
        </div>

        <div class="page-break-before">
            <h2>DECLARATIONS AND AUTHORIZATION</h2>

            <div class="consent-text">
                <p><strong>I/We declare and certify that:</strong></p>
                <ul>
                    <li>All information provided in this application is true, accurate, and complete to the best of
                        my/our knowledge.</li>
                    <li>I/We authorize the landlord/property manager to verify all information provided, including but
                        not limited to employment, income, rental history, and personal references.</li>
                    <li>I/We authorize the landlord to obtain a consumer credit report and conduct criminal background
                        checks, eviction history searches, and other inquiries deemed necessary to assess my/our
                        eligibility and creditworthiness as a tenant.</li>
                    <li>I/We understand that providing false, misleading, or incomplete information may result in the
                        rejection of this application or termination of tenancy if discovered after occupancy has
                        commenced, in accordance with the Residential Tenancy Act of British Columbia.</li>
                    <li>I/We consent to the collection, use, and disclosure of personal information provided in this
                        application for the purposes of: assessing this rental application, managing the tenancy (if
                        approved), responding to emergencies, complying with legal obligations including the Residential
                        Tenancy Act, and collecting unpaid rent or damages. All personal information will be handled in
                        accordance with British Columbia's Personal Information Protection Act (PIPA).</li>
                    <li>I/We understand that this application constitutes an offer to rent and does not create a binding
                        tenancy agreement. The landlord reserves the right to accept or reject this application based on
                        the information provided, verification results, and comparison with other applicants.</li>
                    <li>I/We understand that any application fee paid is non-refundable and is used to cover the costs
                        of processing this application.</li>
                </ul>
            </div>

            <h3>Primary Applicant Signature</h3>
            <div class="signature-row">
                <div class="signature-field">
                    <label>Primary Applicant Full Name:</label>
                    <input type="text" id="primary_signature_name" />
                </div>
            </div>

            <div class="signature-pad-container">
                <label>Draw Signature (or type below):</label>
                <canvas id="primarySignaturePad" width="400" height="150"></canvas>
                <div class="signature-controls">
                    <button type="button" onclick="primarySigPad.clear()">Clear Signature</button>
                </div>
                <label style="margin-top:15px;">OR Type Signature:</label>
                <input type="text" id="primary_typed_signature" class="typed-signature" placeholder="Type full legal name">
            </div>

            <div class="signature-row">
                <div class="signature-field">
                    <label>Date:</label>
                    <input type="text" id="primary_signature_date" />
                </div>
            </div>

            <h3 style="margin-top: 40px;">Co-Applicant Signature (if applicable)</h3>
            <div class="signature-row">
                <div class="signature-field">
                    <label>Co-Applicant Full Name:</label>
                    <input type="text" id="co_signature_name" />
                </div>
            </div>

            <div class="signature-pad-container">
                <label>Draw Signature (or type below):</label>
                <canvas id="coSignaturePad" width="400" height="150"></canvas>
                <div class="signature-controls">
                    <button type="button" onclick="coSigPad.clear()">Clear Signature</button>
                </div>
                <label style="margin-top:15px;">OR Type Signature:</label>
                <input type="text" id="co_typed_signature" class="typed-signature" placeholder="Type full legal name">
            </div>

            <div class="signature-row">
                <div class="signature-field">
                    <label>Date:</label>
                    <input type="text" id="co_signature_date" />
                </div>
            </div>
        </div>

        <div class="button-container">
            <button type="submit" class="btn-download">Generate & Download PDF</button>
            <button type="button" class="btn-clear" onclick="clearForm()">Clear Form</button>
        </div>

</form>
</div>

<script>
const { jsPDF } = window.jspdf;

// Initialize signature pads
const primaryCanvas = document.getElementById("primarySignaturePad");
const coCanvas = document.getElementById("coSignaturePad");
const primarySigPad = new SignaturePad(primaryCanvas);
const coSigPad = new SignaturePad(coCanvas);

// Helper function to get element value safely
function getValue(id) {
    const el = document.getElementById(id);
    return el ? el.value.trim() : '';
}

// Helper function to get radio button value
function getRadioValue(name) {
    const radios = document.querySelectorAll(`input[name="${name}"]:checked`);
    return radios.length > 0 ? radios[0].value : '';
}

// Helper function to format date
function formatDate(dateStr) {
    if (!dateStr) return '';
    try {
        const date = new Date(dateStr);
        return date.toLocaleDateString('en-CA');
    } catch {
        return dateStr;
    }
}

// Clear form function
function clearForm() {
    if (confirm('Are you sure you want to clear all form data?')) {
        document.getElementById('appForm').reset();
        primarySigPad.clear();
        coSigPad.clear();
    }
}

// Validate form
function validateForm() {
    const fullName = getValue('full_name');
    if (!fullName) {
        alert("Primary applicant's full legal name is required.");
        return false;
    }

    const primarySig = !primarySigPad.isEmpty() || getValue('primary_typed_signature');
    if (!primarySig) {
        alert("Primary applicant signature is required.");
        return false;
    }

    return true;
}

// Generate PDF
document.getElementById("appForm").addEventListener("submit", function(e) {
    e.preventDefault();
    if (!validateForm()) return;

    const doc = new jsPDF();
    const pageWidth = doc.internal.pageSize.getWidth();
    const pageHeight = doc.internal.pageSize.getHeight();
    let yPos = 20;
    const margin = 14;
    const lineHeight = 7;

    // Helper function to add new page if needed
    function checkPageBreak(requiredSpace = 20) {
        if (yPos + requiredSpace > pageHeight - 20) {
            doc.addPage();
            yPos = 20;
            return true;
        }
        return false;
    }

    // Helper function to add section header
    function addSectionHeader(title) {
        checkPageBreak(15);
        yPos += 5;
        doc.setFontSize(14);
        doc.setFont(undefined, 'bold');
        doc.setFillColor(221, 221, 221);
        doc.rect(margin, yPos - 5, pageWidth - 2 * margin, 8, 'F');
        doc.setTextColor(44, 62, 80);
        doc.text(title, margin + 2, yPos + 2);
        yPos += 12;
        doc.setFontSize(10);
        doc.setFont(undefined, 'normal');
        doc.setTextColor(0, 0, 0);
    }

    // Helper function to add table
    function addTable(data, startY) {
        doc.autoTable({
            startY: startY,
            body: data,
            styles: { 
                fontSize: 9,
                cellPadding: 3,
                overflow: 'linebreak',
                cellWidth: 'wrap'
            },
            columnStyles: { 
                0: { fontStyle: 'bold', cellWidth: 70 },
                1: { cellWidth: 'auto' }
            },
            margin: { left: margin, right: margin },
            theme: 'grid'
        });
        return doc.lastAutoTable.finalY + 5;
    }

    // Page 1: Title and Property Information
    doc.setFontSize(16);
    doc.setFont(undefined, 'bold');
    doc.text("RESIDENTIAL RENTAL APPLICATION", pageWidth / 2, yPos, { align: "center" });
    yPos += 8;
    doc.setFontSize(10);
    doc.setFont(undefined, 'normal');
    doc.text("Please complete all sections accurately and legibly", pageWidth / 2, yPos, { align: "center" });
    yPos += 10;

    addSectionHeader("PROPERTY INFORMATION");
    const propertyData = [
        ["Property Address", getValue('property_address')],
        ["Desired Move-In Date", getValue('move_in_date')],
        ["Lease Term Requested", getValue('lease_term')]
    ];
    yPos = addTable(propertyData, yPos);

    // Page 2: Primary Applicant Information
    doc.addPage();
    yPos = 20;
    addSectionHeader("PERSONAL INFORMATION - PRIMARY APPLICANT");
    const primaryData = [
        ["Full Legal Name", getValue('full_name')],
        ["Date of Birth", getValue('birthdate')],
        ["Marital Status", getValue('marital_status')],
        ["Primary Phone", getValue('phone')],
        ["Alternate Phone", getValue('cell')],
        ["Email Address", getValue('email')],
        ["Driver's License / ID Number", getValue('license')],
        ["Province/State of Issue", getValue('license_province')]
    ];
    yPos = addTable(primaryData, yPos);

    // Page 3: Current Residence
    doc.addPage();
    yPos = 20;
    addSectionHeader("CURRENT RESIDENCE");
    const currentResidenceData = [
        ["Current Address", getValue('current_address')],
        ["City", getValue('current_city')],
        ["Province", getValue('current_province')],
        ["Postal Code", getValue('current_postal')],
        ["Landlord/Property Manager Name", getValue('current_landlord')],
        ["Landlord Phone", getValue('current_landlord_phone')],
        ["Monthly Rent", getValue('current_rent')],
        ["Move-In Date", getValue('current_start')],
        ["Move-Out Date", getValue('current_end')],
        ["Reason for Leaving", getValue('reason_leaving')]
    ];
    yPos = addTable(currentResidenceData, yPos);

    // Previous Address #1
    checkPageBreak(30);
    doc.setFontSize(11);
    doc.setFont(undefined, 'bold');
    doc.text("Previous Address #1", margin, yPos);
    yPos += 7;
    doc.setFontSize(9);
    doc.setFont(undefined, 'normal');
    const prev1Data = [
        ["Address", getValue('prev_address_1')],
        ["City", getValue('prev_city_1')],
        ["Province", getValue('prev_province_1')],
        ["Postal Code", getValue('prev_postal_1')],
        ["Landlord Name", getValue('prev_landlord_1')],
        ["Landlord Phone", getValue('prev_landlord_phone_1')],
        ["Monthly Rent", getValue('prev_rent_1')],
        ["From Date", getValue('prev_start_1')],
        ["To Date", getValue('prev_end_1')]
    ];
    yPos = addTable(prev1Data, yPos);

    // Previous Address #2
    checkPageBreak(30);
    doc.setFontSize(11);
    doc.setFont(undefined, 'bold');
    doc.text("Previous Address #2", margin, yPos);
    yPos += 7;
    doc.setFontSize(9);
    doc.setFont(undefined, 'normal');
    const prev2Data = [
        ["Address", getValue('prev_address_2')],
        ["City", getValue('prev_city_2')],
        ["Province", getValue('prev_province_2')],
        ["Postal Code", getValue('prev_postal_2')],
        ["Landlord Name", getValue('prev_landlord_2')],
        ["Landlord Phone", getValue('prev_landlord_phone_2')],
        ["Monthly Rent", getValue('prev_rent_2')],
        ["From Date", getValue('prev_start_2')],
        ["To Date", getValue('prev_end_2')]
    ];
    yPos = addTable(prev2Data, yPos);

    // Page 4: Employment & Income
    doc.addPage();
    yPos = 20;
    addSectionHeader("EMPLOYMENT & INCOME");
    
    doc.setFontSize(11);
    doc.setFont(undefined, 'bold');
    doc.text("Current Employment", margin, yPos);
    yPos += 7;
    doc.setFontSize(9);
    doc.setFont(undefined, 'normal');
    const currentEmploymentData = [
        ["Employer Name", getValue('employer')],
        ["Occupation/Position", getValue('occupation')],
        ["Employer Address", getValue('employer_address')],
        ["Supervisor Name", getValue('supervisor')],
        ["Employer Phone", getValue('employer_phone')],
        ["Employment Start Date", getValue('employment_start')],
        ["Gross Monthly Income", getValue('monthly_income')],
        ["Employment Type", getValue('employment_type')]
    ];
    yPos = addTable(currentEmploymentData, yPos);

    checkPageBreak(25);
    doc.setFontSize(11);
    doc.setFont(undefined, 'bold');
    doc.text("Previous Employment", margin, yPos);
    yPos += 7;
    doc.setFontSize(9);
    doc.setFont(undefined, 'normal');
    const prevEmploymentData = [
        ["Employer Name", getValue('prev_employer')],
        ["Occupation/Position", getValue('prev_occupation')],
        ["Employer Phone", getValue('prev_employer_phone')],
        ["From Date", getValue('prev_employment_start')],
        ["To Date", getValue('prev_employment_end')]
    ];
    yPos = addTable(prevEmploymentData, yPos);

    checkPageBreak(15);
    doc.setFontSize(11);
    doc.setFont(undefined, 'bold');
    doc.text("Additional Income Sources", margin, yPos);
    yPos += 7;
    doc.setFontSize(9);
    doc.setFont(undefined, 'normal');
    const otherIncomeData = [
        ["Other Income Source", getValue('other_income_source')],
        ["Monthly Amount", getValue('other_income_amount')]
    ];
    yPos = addTable(otherIncomeData, yPos);

    // Page 5: Vehicle, Occupants, Pets
    doc.addPage();
    yPos = 20;
    addSectionHeader("VEHICLE INFORMATION");
    const vehicleOwned = getRadioValue('vehicle_owned');
    const vehicleData = [
        ["Do you own a vehicle?", vehicleOwned || ''],
        ["Vehicle Make/Model", getValue('vehicle_make')],
        ["Year", getValue('vehicle_year')],
        ["License Plate", getValue('vehicle_plate')]
    ];
    yPos = addTable(vehicleData, yPos);

    addSectionHeader("ADDITIONAL OCCUPANTS");
    doc.setFontSize(11);
    doc.setFont(undefined, 'bold');
    doc.text("Spouse/Co-Applicant", margin, yPos);
    yPos += 7;
    doc.setFontSize(9);
    doc.setFont(undefined, 'normal');
    const spouseData = [
        ["Full Name", getValue('spouse_name')],
        ["Date of Birth", formatDate(getValue('spouse_dob'))],
        ["Phone", getValue('spouse_phone')],
        ["Email", getValue('spouse_email')],
        ["Employer", getValue('spouse_employer')],
        ["Occupation", getValue('spouse_occupation')],
        ["Employer Phone", getValue('spouse_employer_phone')],
        ["Gross Monthly Income", getValue('spouse_income')]
    ];
    yPos = addTable(spouseData, yPos);

    checkPageBreak(20);
    doc.setFontSize(11);
    doc.setFont(undefined, 'bold');
    doc.text("Other Occupants", margin, yPos);
    yPos += 7;
    doc.setFontSize(9);
    doc.setFont(undefined, 'normal');
    const occupantsData = [
        ["Number of Adults (18+)", getValue('num_adults')],
        ["Number of Children (Under 18)", getValue('num_children')]
    ];
    yPos = addTable(occupantsData, yPos);

    // List occupants
    const occupants = [];
    for (let i = 1; i <= 3; i++) {
        const name = getValue(`occupant${i}_name`);
        if (name) {
            occupants.push([
                `Occupant ${i}`,
                `Name: ${name}, Relationship: ${getValue(`occupant${i}_relationship`)}, Age: ${getValue(`occupant${i}_age`)}`
            ]);
        }
    }
    if (occupants.length > 0) {
        checkPageBreak(occupants.length * 8);
        yPos = addTable(occupants, yPos);
    }

    checkPageBreak(20);
    addSectionHeader("PETS & SMOKING");
    const petsSmokingData = [
        ["Do you have pets?", getRadioValue('pets') || ''],
        ["Pet Details", getValue('pet_details')],
        ["Do you or any occupants smoke?", getRadioValue('smokers') || '']
    ];
    yPos = addTable(petsSmokingData, yPos);

    // Page 6: Emergency Contact, References
    doc.addPage();
    yPos = 20;
    addSectionHeader("EMERGENCY CONTACT");
    const emergencyData = [
        ["Name", getValue('emergency_name')],
        ["Relationship", getValue('emergency_relationship')],
        ["Phone", getValue('emergency_phone')],
        ["Alternate Phone", getValue('emergency_alt_phone')]
    ];
    yPos = addTable(emergencyData, yPos);

    addSectionHeader("REFERENCES");
    for (let i = 1; i <= 3; i++) {
        checkPageBreak(25);
        doc.setFontSize(11);
        doc.setFont(undefined, 'bold');
        doc.text(`Reference ${i}`, margin, yPos);
        yPos += 7;
        doc.setFontSize(9);
        doc.setFont(undefined, 'normal');
        const refData = [
            ["Name", getValue(`ref${i}_name`)],
            ["Relationship", getValue(`ref${i}_relationship`)],
            ["Phone", getValue(`ref${i}_phone`)],
            ["Email", getValue(`ref${i}_email`)]
        ];
        yPos = addTable(refData, yPos);
    }

    // Page 7: Additional Questions
    doc.addPage();
    yPos = 20;
    addSectionHeader("ADDITIONAL QUESTIONS");
    const additionalQuestionsData = [
        ["Ever been evicted?", getRadioValue('evicted') || ''],
        ["Eviction Explanation", getValue('evicted_explanation')],
        ["Ever broken a lease?", getRadioValue('broken_lease') || ''],
        ["Broken Lease Explanation", getValue('broken_lease_explanation')],
        ["Ever filed for bankruptcy?", getRadioValue('bankruptcy') || ''],
        ["Bankruptcy Details", getValue('bankruptcy_details')],
        ["Ever convicted of criminal offense?", getRadioValue('criminal') || ''],
        ["Criminal Explanation", getValue('criminal_explanation')],
        ["Renters Insurance", getRadioValue('insurance') || '']
    ];
    yPos = addTable(additionalQuestionsData, yPos);

    checkPageBreak(15);
    addSectionHeader("ADDITIONAL INFORMATION");
    const additionalInfo = getValue('additional_info');
    if (additionalInfo) {
        doc.setFontSize(9);
        const splitText = doc.splitTextToSize(additionalInfo, pageWidth - 2 * margin);
        doc.text(splitText, margin, yPos);
        yPos += splitText.length * 5;
    }

    // Page 8: Declarations and Signatures
    doc.addPage();
    yPos = 20;
    addSectionHeader("DECLARATIONS AND AUTHORIZATION");
    
    doc.setFontSize(8);
    const declarations = [
        "I/We declare and certify that:",
        "• All information provided in this application is true, accurate, and complete.",
        "• I/We authorize verification of all information provided.",
        "• I/We authorize credit reports, criminal background checks, and eviction history searches.",
        "• I/We understand that false information may result in rejection or termination.",
        "• I/We consent to collection, use, and disclosure of personal information per PIPA.",
        "• This application constitutes an offer to rent, not a binding tenancy agreement.",
        "• Any application fee paid is non-refundable."
    ];
    
    declarations.forEach(declaration => {
        checkPageBreak(6);
        const splitText = doc.splitTextToSize(declaration, pageWidth - 2 * margin);
        doc.text(splitText, margin, yPos);
        yPos += splitText.length * 5;
    });

    // Primary Applicant Signature
    checkPageBreak(50);
    doc.setFontSize(11);
    doc.setFont(undefined, 'bold');
    doc.text("Primary Applicant", margin, yPos);
    yPos += 7;
    doc.setFontSize(9);
    doc.setFont(undefined, 'normal');
    doc.text(`Full Name: ${getValue('primary_signature_name')}`, margin, yPos);
    yPos += 6;
    
    // Add signature image or typed signature
    const primarySigName = getValue('primary_typed_signature');
    if (!primarySigPad.isEmpty()) {
        try {
            const sigData = primarySigPad.toDataURL();
            doc.addImage(sigData, 'PNG', margin, yPos, 80, 30);
            yPos += 35;
        } catch (e) {
            doc.text(primarySigName || 'Signature required', margin, yPos + 10);
            yPos += 15;
        }
    } else if (primarySigName) {
        doc.setFont(undefined, 'italic');
        doc.text(primarySigName, margin, yPos + 10);
        yPos += 15;
    }
    
    doc.setFont(undefined, 'normal');
    doc.text(`Date: ${getValue('primary_signature_date') || new Date().toLocaleDateString()}`, margin, yPos);

    // Co-Applicant Signature
    const coName = getValue('co_signature_name');
    if (coName || !coSigPad.isEmpty() || getValue('co_typed_signature')) {
        checkPageBreak(50);
        yPos += 10;
        doc.setFontSize(11);
        doc.setFont(undefined, 'bold');
        doc.text("Co-Applicant", margin, yPos);
        yPos += 7;
        doc.setFontSize(9);
        doc.setFont(undefined, 'normal');
        doc.text(`Full Name: ${coName}`, margin, yPos);
        yPos += 6;
        
        const coSigName = getValue('co_typed_signature');
        if (!coSigPad.isEmpty()) {
            try {
                const sigData = coSigPad.toDataURL();
                doc.addImage(sigData, 'PNG', margin, yPos, 80, 30);
                yPos += 35;
            } catch (e) {
                doc.text(coSigName || 'Signature required', margin, yPos + 10);
                yPos += 15;
            }
        } else if (coSigName) {
            doc.setFont(undefined, 'italic');
            doc.text(coSigName, margin, yPos + 10);
            yPos += 15;
        }
        
        doc.setFont(undefined, 'normal');
        doc.text(`Date: ${getValue('co_signature_date') || new Date().toLocaleDateString()}`, margin, yPos);
    }

    // Save PDF
    doc.save("Residential-Rental-Application.pdf");
});
</script>

</body>
</html>
